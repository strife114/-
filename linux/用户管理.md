# **用户相关文件**

## /etc/passwd	用户信息文件

Root:x:0:0:root:/root:/bin/bash    (冒号分隔列)

第一列：用户名

第二列：密码标志  真实密码路径：/etc/shadow

第三列：用户ID  超级用户为0，系统用户为1-499，普通用户500-65535

第四列：组ID  组信息路径：/etc/group

第五列：用户说明（使用chfn命令修改说明）

第六列：用户家目录

第七列：登录shell（登录操作界面） /bin/bash（获取本用户的权限） /sbin/nologin（禁止登录）

 

## /etc/shadow  影子文件(密码文件)

Csminzhnmvhmx:15775:0:99999:7:::

第一列： 用户名

第二列： 加密密码  

“！ ！”或“*”代表没有密码或空密码，可以在密码前加入“！”或“*”让密码暂时失效

第三列： 密码最近更改时间  

1970.1.1为初始时间，例如17213为1970.1.1后的17213天

​     时间戳转日期

​     \#date  -d “1970-01-01” 15575（时间戳） days

​     日期转时间戳

​     \#echo  $( ($(date --date=”当前时间”+%s)/86400+1) )

第四列：设置修改密码的间隔时间（和第三列相比）

第五列：密码有效期（和第三列相比）（相比第三列后的180天）

第六列：密码到期前的警告天数（和第五列相比）

第七列：密码到期后的宽限天数（和第五列相比）

默认-1，代表到期后也可以正常使用

第八列：密码失效时间（时间戳）     

第九列：保留

## /etc/group  组信息文件

  Root:x:0:root

​    第一列： 组名

​    第二列： 组密码位

​    第三列： GID

​    第四列： 附加用户

​     初始组：每个用户初始组只有一个，初始组只有一个，一般是和用户名相同的组作为初始组

​     附加组：每个用户可以有多个附加组，要把用户加入组，都是加u人附加组 

\4. /etc/gshadow 组密码文件

如果给用户组设置了组管理员，并给该用户组设定了组密码，组密码就在这个文件中

\5. /home/  用户家目录 

\6. /var/spool/mail   用户邮箱目录

\7. /etc/skel/  用户模板目录（用户初始目录）

手工删除1-6文件中的指定用户的数据可以起到删除用户的作用

 

# **添加用户**

```
#useradd 选项 用户名

 选项：

 -u  550  指定uid

 -g  组名  指定初始组

 -G  组名  指定附加组   

 -c  说明  添加说明

 -d  目录  手工指定家目录

 -s  shell   /bin/bash.  

 -M     不建立家目录	 

​      
```

 用户默认值：

\1. /etc/default/useradd

​    GROUP=100    建立用户的默认值，目前是私有用户机制，此处无用

​    HOME=/home      建立用户家目录的默认位置

​    INACTIVE=-1      密码过期后的宽限天数，-1为不过期

​    EXPIRE=        密码失效时间（不建议使用）

​    SHELL=/bin/bash     默认登录权限

​    CREATE_MAIL_SPOLL=yes    默认创建邮箱

​       

\2. /etc/login.defs

MAIL_DIR  /var/spool/mail   默认邮箱位置

PASS_MAX_DAYS  999     密码有效期

PASS_MIN_DAYS   0     修改间隔时间

PASS_MIN_LEN   5     密码最小长度（不起效）

PASS_WARN_AGE  7     密码到期前的的警告天数

UID_MIN  UIN_MAX     uid范围

GIN_MIN  GIN_MAX     组id范围

CRATE_HOME  yes      是否自动建立用户家目录，默认建立

UMASK  077        家目录默认权限

USERGROUPS_ENAB  yes   是否删除用户初始组，默认删除

Encrypt_METHOD   SHA512   指定用户密码加密方式

 

 

# **设置密码**

```
#passwd  选项  用户名

选项:

 -l    暂时锁定用户，root权限

 -u    解锁用户，root权限

 --stdin  通过管道符输出的数据作为用户的密码，主要使用在批量添加用户时

   

#passwd   修改当前用户密码（自己修改自己密码遵守密码原则）

#echo “123” | passwd  --stdin  lamp(用户名)  更该用户lamp的密码

#chage  -d  0  lamp  把密码修改日期（三段）归零，作用于用户只要登陆就要修改密码
```

![img](file:///C:\Users\ASUS\AppData\Local\Temp\ksohtml16964\wps1.jpg) 

# **用户信息修改**

```
# usermod  选项  用户名

选项：

-u UID       修改用户uid

-d 家目录      修改用户家目录（绝对路径）

-c 用户说明     修改用户说明信息

-g 组名       修改用户初始组

-G 组名       修改用户附加组

-s  shell      修改用户登录shell，默认/bin/bash.

-e  日期      修改用户失效日期，格式：YYYY-MM-DD

-L          临时锁定用户

-U          解锁用户

 

#usermod  -l  新名  旧名    修改用户名（其属性不变）
```

 

# **删除用户**

```
#userdel  -r  用户名

-r  删除用户同时删除用户家目录
```



#  

# **切换用户身份**

```
 #su   选项   用户名

选项：

 “-”   切换用户的同时也切换用户环境变量

  -c    仅执行一次命令。不切换用户
```

 

# **组管理命令**

```
#groupadd  选项   组名     创建组

选项：

-g  GID        指定组id




#groupdel    组名        删除组

 
#gpasswd  -a  用户名  组名   把用户加入组

#gpasswd  -d  用户名  组名   把用户删除组  
```

   

 

# **该变有效组**

​    有效组：，当此用户有多个附加组时，改变有效组来改变用户创建文件或目录时所属者和所属组的属性

​    例如root就是root有效组组但有user附加组，改为user1有效组，所属者和所属者就是user1

 

  

```
#newgrp  组名
```

   